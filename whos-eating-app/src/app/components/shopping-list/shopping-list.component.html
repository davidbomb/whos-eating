<div class="shopping-list-container" [class.dark-mode]="darkMode">
  <!-- ğŸŒ€ Animation de Tornade Bleue Magique ğŸŒ€ -->
  <div class="blue-tornado-overlay" *ngIf="showBlueTornado">
    <div class="tornado-container">
      <div class="tornado-spiral tornado-spiral-1">ğŸŒ€</div>
      <div class="tornado-spiral tornado-spiral-2">ğŸŒ€</div>
      <div class="tornado-spiral tornado-spiral-3">ğŸŒ€</div>
      <div class="tornado-spiral tornado-spiral-4">ğŸŒ€</div>
      <div class="tornado-spiral tornado-spiral-5">ğŸŒ€</div>
      <div class="tornado-magic tornado-magic-2">âœ¨</div>
      <div class="tornado-magic tornado-magic-3">âœ¨</div>
    </div>
  </div>

  <!-- âœ¨ Animation Globale de 8 Ã‰toiles Magiques âœ¨ -->
  <div class="global-magic-stars" *ngIf="showGlobalMagicStars">
    <span class="star star-1"
          [style.top.%]="globalStarPositions[0]?.top"
          [style.left.%]="globalStarPositions[0]?.left">âœ¨</span>
    <span class="star star-2"
          [style.top.%]="globalStarPositions[1]?.top"
          [style.left.%]="globalStarPositions[1]?.left">âœ¨</span>
    <span class="star star-3"
          [style.top.%]="globalStarPositions[2]?.top"
          [style.left.%]="globalStarPositions[2]?.left">âœ¨</span>
    <span class="star star-4"
          [style.top.%]="globalStarPositions[3]?.top"
          [style.left.%]="globalStarPositions[3]?.left">âœ¨</span>
    <span class="star star-5"
          [style.top.%]="globalStarPositions[4]?.top"
          [style.left.%]="globalStarPositions[4]?.left">âœ¨</span>
    <span class="star star-6"
          [style.top.%]="globalStarPositions[5]?.top"
          [style.left.%]="globalStarPositions[5]?.left">âœ¨</span>
    <span class="star star-7"
          [style.top.%]="globalStarPositions[6]?.top"
          [style.left.%]="globalStarPositions[6]?.left">âœ¨</span>
    <span class="star star-8"
          [style.top.%]="globalStarPositions[7]?.top"
          [style.left.%]="globalStarPositions[7]?.left">âœ¨</span>
  </div>

  <div class="shopping-header">
    <h2>ğŸ Victuailles Ã  acheter</h2>
    <p class="subtitle">{{ uncheckedCount }} article(s) Ã  acheter</p>
  </div>

  <div class="add-item-section">
    <div class="input-group">
      <input
        type="text"
        [(ngModel)]="newItem"
        placeholder="Ajouter un ingrÃ©dient..."
        class="item-input"
        (keyup.enter)="addItem()"
      />
      <button
        (click)="addItem()"
        class="add-button"
        [disabled]="!newItem.trim()"
      >
        â• Ajouter
      </button>
    </div>
  </div>

  <div class="items-list" *ngIf="shoppingItems.length > 0">
    <div
      *ngFor="let item of shoppingItems; trackBy: trackByItemId"
      class="shopping-item"
      [class.checked]="item.checked"
      [class.fading-out]="item.fadingOut"
      [@itemAnimation]
    >
      <div class="item-content" (click)="toggleItem(item)">
        <div class="checkbox">
          <span *ngIf="item.checked">âœ“</span>
        </div>
        <div class="item-details">
          <span class="item-name">{{ item.name }}</span>
        </div>
      </div>
      <button
        (click)="deleteItem(item.id)"
        class="delete-button"
        title="Supprimer"
      >
        ğŸª„ï¸
      </button>

      <!-- âœ¨ Animation d'Ã©toiles magiques âœ¨ -->
      <div class="magic-stars" *ngIf="item.showMagicStars">
        <span class="star star-1"
              [style.top.%]="item.randomStarPositions?.[0]?.top || 50"
              [style.left.%]="item.randomStarPositions?.[0]?.left || 50">âœ¨</span>
        <span class="star star-2"
              [style.top.%]="item.randomStarPositions?.[1]?.top || 5"
              [style.left.%]="item.randomStarPositions?.[1]?.left || 20">âœ¨</span>
        <span class="star star-3"
              [style.top.%]="item.randomStarPositions?.[2]?.top || 5"
              [style.left.%]="item.randomStarPositions?.[2]?.left || 95">âœ¨</span>
        <span class="star star-4"
              [style.top.%]="item.randomStarPositions?.[3]?.top || 95"
              [style.left.%]="item.randomStarPositions?.[3]?.left || 70">âœ¨</span>
        <span class="star star-5"
              [style.top.%]="item.randomStarPositions?.[4]?.top || 70"
              [style.left.%]="item.randomStarPositions?.[4]?.left || 2">âœ¨</span>
        <span class="star star-6"
              [style.top.%]="item.randomStarPositions?.[5]?.top || 20"
              [style.left.%]="item.randomStarPositions?.[5]?.left || 5">âœ¨</span>
        <span class="star star-7"
              [style.top.%]="item.randomStarPositions?.[6]?.top || 95"
              [style.left.%]="item.randomStarPositions?.[6]?.left || 95">âœ¨</span>
        <span class="star star-8"
              [style.top.%]="item.randomStarPositions?.[7]?.top || 35"
              [style.left.%]="item.randomStarPositions?.[7]?.left || 98">âœ¨</span>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="shoppingItems.length === 0">
    <p>Aucun article dans la liste</p>
    <p class="empty-subtitle">Ajoutez votre premier ingrÃ©dient !</p>
  </div>

  <div class="actions" *ngIf="shoppingItems.length > 0">
    <button
      (click)="openConfirmModal()"
      class="clear-button"
    >
      ğŸ§™ğŸ»â€ Vider toute la liste
    </button>
  </div>

  <!-- Modale de confirmation -->
  <div class="modal-overlay" *ngIf="showConfirmModal" (click)="closeConfirmModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <span style="font-size: 2rem">ğŸ”®</span>
        <h3>Confirmation Requise</h3>
        <span style="font-size: 2rem">ğŸ”®</span>
      </div>
      <div class="modal-body">
        <p>ÃŠtes-vous sÃ»r de vouloir supprimer TOUS les articles de la liste ?</p>
        <p class="modal-warning">Cette magie noire est irrÃ©versible !</p>
      </div>
      <div class="modal-actions">
        <button class="modal-cancel-button" (click)="closeConfirmModal()">
          âŒ Annuler
        </button>
        <button class="modal-confirm-button" (click)="confirmClearAllItems()">
          âœ“ Confirmer
        </button>
      </div>
    </div>
  </div>
</div>
