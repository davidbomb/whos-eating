<div class="container">
  <header class="header">
    <h1 class="title">{{ title }}</h1>
    <div class="date">{{ getCurrentDate() }}</div>
  </header>

  <div class="counter-section">
    <div class="table-container">
      <div class="table-top">
        <div class="table-wood-grain"></div>
        <div class="counter-number">{{ totalCount }}</div>
        <div class="counter-label">convive{{ totalCount > 1 ? 's' : '' }}</div>

        <!-- Assiettes autour de la table - positionnement dynamique -->
        <div class="plates-container">
          <div
            *ngFor="let plate of getPlates(); let i = index"
            class="plate"
            [style.top.%]="plate.top"
            [style.left.%]="plate.left"
            [style.transform]="plate.transform">
            <div class="plate-inner"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="add-section">
    <h2 class="section-title">Qui vient manger ?</h2>

    <div class="family-grid">
      <div *ngFor="let member of familyMembers" class="member-card">
        <button
          class="member-btn"
          [class.registered]="hasMemberRegistered(member)"
          [disabled]="hasMemberRegistered(member)"
          (click)="addMember(member)">
          <span class="member-name">{{ member }}</span>
          <span class="member-status">{{ hasMemberRegistered(member) ? 'âœ“' : '+' }}</span>
        </button>

        <div class="member-actions" *ngIf="hasMemberRegistered(member)">
          <button class="action-btn guest-add-btn" (click)="openGuestForm(member)" title="Ajouter un invitÃ©">
            ğŸ‘¤+
          </button>
          <button class="action-btn member-remove-btn" (click)="removeMember(member)" title="Se dÃ©sinscrire">
            âœ•
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="participants-section" *ngIf="participants.length > 0">
    <h2 class="section-title">Participants ({{ totalCount }})</h2>
    <div class="participants-list">
      <div *ngFor="let participant of participants" class="participant-card">
        <div class="participant-info">
          <span class="participant-icon">{{ participant.isGuest ? 'ğŸ‘¤' : 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' }}</span>
          <div class="participant-details">
            <span class="participant-name">{{ participant.name }}</span>
            <span class="participant-label" *ngIf="participant.isGuest">
              (invitÃ© de {{ participant.addedBy }})
            </span>
          </div>
        </div>
        <button class="remove-btn" (click)="removeParticipant(participant)" title="Retirer">âœ•</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" *ngIf="showGuestForm" (click)="cancelGuestForm()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h3 class="modal-title">InvitÃ© de {{ selectedMember }}</h3>
      <input
        type="text"
        class="guest-input"
        [(ngModel)]="guestName"
        placeholder="Nom de l'invitÃ©"
        (keyup.enter)="addGuest(selectedMember)"
        autofocus>
      <div class="modal-buttons">
        <button class="btn-cancel" (click)="cancelGuestForm()">Annuler</button>
        <button class="btn-confirm" (click)="addGuest(selectedMember)" [disabled]="!guestName.trim()">Ajouter</button>
      </div>
    </div>
  </div>

  <footer class="footer" *ngIf="participants.length > 0">
    <button class="reset-btn" (click)="resetDay()">ğŸ”„ RÃ©initialiser</button>
  </footer>
</div>
